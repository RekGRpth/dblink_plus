\c contrib_regression_utf8
-- upper
EXPLAIN (COSTS FALSE) 
SELECT id, val2 FROM ft_char_b WHERE upper(val2) = 'ABCBA' ORDER BY id;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", NULL, "val2" FROM "oracle_fdw"."t_char_b" WHERE (UPPER(RTRIM("val2")) = 'ABCBA')
(4 rows)

SELECT id, val2 FROM ft_char_b WHERE upper(val2) = 'ABCBA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | AbCbA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_char_b AS (SELECT id, val2 FROM ft_char_b)
SELECT id, val2 FROM ft_char_b WHERE upper(val2) = 'ABCBA' ORDER BY id;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Sort
   Sort Key: ft_char_b.id
   CTE ft_char_b
     ->  Foreign Scan on ft_char_b
           Remote SQL: SELECT "id", NULL, "val2" FROM "oracle_fdw"."t_char_b"
   ->  CTE Scan on ft_char_b
         Filter: (upper((val2)::text) = 'ABCBA'::text)
(7 rows)

WITH ft_char_b AS (SELECT id, val2 FROM ft_char_b)
SELECT id, val2 FROM ft_char_b WHERE upper(val2) = 'ABCBA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | AbCbA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

SELECT id, val2 FROM ft_char_b WHERE upper(val2) = 'あぁアァ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  4 | あぁアァ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
(1 row)

WITH ft_char_b AS (SELECT id, val2 FROM ft_char_b)
SELECT id, val2 FROM ft_char_b WHERE upper(val2) = 'あぁアァ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  4 | あぁアァ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
(1 row)

SELECT id, val2 FROM ft_char_b WHERE upper(val2) = ' ＡＡＢＢＣＣ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(1 row)

WITH ft_char_b AS (SELECT id, val2 FROM ft_char_b)
SELECT id, val2 FROM ft_char_b WHERE upper(val2) = ' ＡＡＢＢＣＣ' ORDER BY id;
 id | val2 
----+------
(0 rows)

SELECT id, val2 FROM ft_char_b WHERE upper(val2) = '' ORDER BY id;
 id | val2 
----+------
(0 rows)

WITH ft_char_b AS (SELECT id, val2 FROM ft_char_b)
SELECT id, val2 FROM ft_char_b WHERE upper(val2) = '' ORDER BY id;
 id | val2 
----+------
(0 rows)

SELECT id, val2 FROM ft_char_b WHERE upper(val2) IS NULL ORDER BY id;
 id | val2 
----+------
  1 | 
  2 | 
(2 rows)

WITH ft_char_b AS (SELECT id, val2 FROM ft_char_b)
SELECT id, val2 FROM ft_char_b WHERE upper(val2) IS NULL ORDER BY id;
 id | val2 
----+------
  1 | 
  2 | 
(2 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val2 FROM ft_char_c WHERE upper(val2) = 'ABCBA' ORDER BY id;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_c
         Remote SQL: SELECT "id", NULL, "val2" FROM "oracle_fdw"."t_char_c" WHERE (UPPER(RTRIM("val2")) = 'ABCBA')
(4 rows)

SELECT id, val2 FROM ft_char_c WHERE upper(val2) = 'ABCBA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | AbCbA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_char_c AS (SELECT id, val2 FROM ft_char_c)
SELECT id, val2 FROM ft_char_c WHERE upper(val2) = 'ABCBA' ORDER BY id;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Sort
   Sort Key: ft_char_c.id
   CTE ft_char_c
     ->  Foreign Scan on ft_char_c
           Remote SQL: SELECT "id", NULL, "val2" FROM "oracle_fdw"."t_char_c"
   ->  CTE Scan on ft_char_c
         Filter: (upper((val2)::text) = 'ABCBA'::text)
(7 rows)

WITH ft_char_c AS (SELECT id, val2 FROM ft_char_c)
SELECT id, val2 FROM ft_char_c WHERE upper(val2) = 'ABCBA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | AbCbA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

SELECT id, val2 FROM ft_char_c WHERE upper(val2) = 'あぁアァ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  4 | あぁアァ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
(1 row)

WITH ft_char_c AS (SELECT id, val2 FROM ft_char_c)
SELECT id, val2 FROM ft_char_c WHERE upper(val2) = 'あぁアァ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  4 | あぁアァ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
(1 row)

SELECT id, val2 FROM ft_char_c WHERE upper(val2) = ' ＡＡＢＢＣＣ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(1 row)

WITH ft_char_c AS (SELECT id, val2 FROM ft_char_c)
SELECT id, val2 FROM ft_char_c WHERE upper(val2) = ' ＡＡＢＢＣＣ' ORDER BY id;
 id | val2 
----+------
(0 rows)

SELECT id, val2 FROM ft_char_c WHERE upper(val2) = '' ORDER BY id;
 id | val2 
----+------
(0 rows)

WITH ft_char_c AS (SELECT id, val2 FROM ft_char_c)
SELECT id, val2 FROM ft_char_c WHERE upper(val2) = '' ORDER BY id;
 id | val2 
----+------
(0 rows)

SELECT id, val2 FROM ft_char_c WHERE upper(val2) IS NULL ORDER BY id;
 id | val2 
----+------
  1 | 
  2 | 
(2 rows)

WITH ft_char_c AS (SELECT id, val2 FROM ft_char_c)
SELECT id, val2 FROM ft_char_c WHERE upper(val2) IS NULL ORDER BY id;
 id | val2 
----+------
  1 | 
  2 | 
(2 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = 'ABCBA' ORDER BY id;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", NULL, "val2" FROM "oracle_fdw"."t_varchar2_b" WHERE (UPPER("val2") = 'ABCBA')
(4 rows)

SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = 'ABCBA' ORDER BY id;
 id | val2  
----+-------
  3 | AbCbA
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_varchar2_b_varchar AS (SELECT id, val2 FROM ft_varchar2_b_varchar)
SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = 'ABCBA' ORDER BY id;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: ft_varchar2_b_varchar.id
   CTE ft_varchar2_b_varchar
     ->  Foreign Scan on ft_varchar2_b_varchar
           Remote SQL: SELECT "id", NULL, "val2" FROM "oracle_fdw"."t_varchar2_b"
   ->  CTE Scan on ft_varchar2_b_varchar
         Filter: (upper((val2)::text) = 'ABCBA'::text)
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val2 FROM ft_varchar2_b_varchar)
SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = 'ABCBA' ORDER BY id;
 id | val2  
----+-------
  3 | AbCbA
(1 row)

SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = 'あぁアァ' ORDER BY id;
 id |   val2   
----+----------
  4 | あぁアァ
(1 row)

WITH ft_varchar2_b_varchar AS (SELECT id, val2 FROM ft_varchar2_b_varchar)
SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = 'あぁアァ' ORDER BY id;
 id |   val2   
----+----------
  4 | あぁアァ
(1 row)

SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = ' ＡＡＢＢＣＣ' ORDER BY id;
 id |     val2      
----+---------------
  7 |  ＡａＢｂＣｃ
(1 row)

WITH ft_varchar2_b_varchar AS (SELECT id, val2 FROM ft_varchar2_b_varchar)
SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = ' ＡＡＢＢＣＣ' ORDER BY id;
 id | val2 
----+------
(0 rows)

SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = '' ORDER BY id;
 id | val2 
----+------
(0 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val2 FROM ft_varchar2_b_varchar)
SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) = '' ORDER BY id;
 id | val2 
----+------
(0 rows)

SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) IS NULL ORDER BY id;
 id | val2 
----+------
  1 | 
  2 | 
(2 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val2 FROM ft_varchar2_b_varchar)
SELECT id, val2 FROM ft_varchar2_b_varchar WHERE upper(val2) IS NULL ORDER BY id;
 id | val2 
----+------
  1 | 
  2 | 
(2 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val2 FROM ft_nchar WHERE upper(val2) = 'ABCBA' ORDER BY id;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nchar
         Remote SQL: SELECT "id", NULL, "val2" FROM "oracle_fdw"."t_nchar" WHERE (UPPER(RTRIM("val2")) = 'ABCBA')
(4 rows)

SELECT id, val2 FROM ft_nchar WHERE upper(val2) = 'ABCBA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | AbCbA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_nchar AS (SELECT id, val2 FROM ft_nchar)
SELECT id, val2 FROM ft_nchar WHERE upper(val2) = 'ABCBA' ORDER BY id;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort
   Sort Key: ft_nchar.id
   CTE ft_nchar
     ->  Foreign Scan on ft_nchar
           Remote SQL: SELECT "id", NULL, "val2" FROM "oracle_fdw"."t_nchar"
   ->  CTE Scan on ft_nchar
         Filter: (upper((val2)::text) = 'ABCBA'::text)
(7 rows)

WITH ft_nchar AS (SELECT id, val2 FROM ft_nchar)
SELECT id, val2 FROM ft_nchar WHERE upper(val2) = 'ABCBA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | AbCbA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

SELECT id, val2 FROM ft_nchar WHERE upper(val2) = 'あぁアァ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  4 | あぁアァ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
(1 row)

WITH ft_nchar AS (SELECT id, val2 FROM ft_nchar)
SELECT id, val2 FROM ft_nchar WHERE upper(val2) = 'あぁアァ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  4 | あぁアァ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
(1 row)

SELECT id, val2 FROM ft_nchar WHERE upper(val2) = ' ＡＡＢＢＣＣ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(1 row)

WITH ft_nchar AS (SELECT id, val2 FROM ft_nchar)
SELECT id, val2 FROM ft_nchar WHERE upper(val2) = ' ＡＡＢＢＣＣ' ORDER BY id;
 id | val2 
----+------
(0 rows)

SELECT id, val2 FROM ft_nchar WHERE upper(val2) = '' ORDER BY id;
 id | val2 
----+------
(0 rows)

WITH ft_nchar AS (SELECT id, val2 FROM ft_nchar)
SELECT id, val2 FROM ft_nchar WHERE upper(val2) = '' ORDER BY id;
 id | val2 
----+------
(0 rows)

SELECT id, val2 FROM ft_nchar WHERE upper(val2) IS NULL ORDER BY id;
 id | val2 
----+------
  1 | 
  2 | 
(2 rows)

WITH ft_nchar AS (SELECT id, val2 FROM ft_nchar)
SELECT id, val2 FROM ft_nchar WHERE upper(val2) IS NULL ORDER BY id;
 id | val2 
----+------
  1 | 
  2 | 
(2 rows)

