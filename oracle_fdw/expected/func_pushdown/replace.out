\c contrib_regression_utf8
-- replace
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b" WHERE (REPLACE(RTRIM("val1"),'a','A') = 'AbcbA')
(4 rows)

SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Sort
   Sort Key: ft_char_b.id
   CTE ft_char_b
     ->  Foreign Scan on ft_char_b
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
   ->  CTE Scan on ft_char_b
         Filter: (replace((val1)::text, 'a'::text, 'A'::text) = 'AbcbA'::text)
(7 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

SELECT id, val1 FROM ft_char_b WHERE replace(val1, '', 'ABC') = 'abcba' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace(val1, '', 'ABC') = 'abcba' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
(4 rows)

SELECT id, val1 FROM ft_char_b WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 | 
  2 | 
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  4 | あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  5 |  abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  6 |  あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(7 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 | 
  2 | 
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  4 | あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  5 |  abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  6 |  あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(7 rows)

SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'abc', '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'abc', '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
(4 rows)

SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 | 
  2 | 
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  4 | あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  5 |  abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  6 |  あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(7 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 | 
  2 | 
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  4 | あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  5 |  abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  6 |  あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(7 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b" WHERE (REPLACE('AAabcbaAA',RTRIM("val1"),'X') = 'AAXAA')
(4 rows)

SELECT id, val1 FROM ft_char_b WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Sort
   Sort Key: ft_char_b.id
   CTE ft_char_b
     ->  Foreign Scan on ft_char_b
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
   ->  CTE Scan on ft_char_b
         Filter: (replace('AAabcbaAA'::text, (val1)::text, 'X'::text) = 'AAXAA'::text)
(7 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

SELECT id, val1 FROM ft_char_b WHERE replace('', val1, 'X') IS NULL ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 | 
  2 | 
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  4 | あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  5 |  abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  6 |  あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(7 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace('', val1, 'X') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

SELECT id, val1 FROM ft_char_b WHERE replace('', val1, '') IS NULL ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 | 
  2 | 
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  4 | あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  5 |  abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  6 |  あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(7 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace('', val1, '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace(NULL, val1, 'X') IS NULL ORDER BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
(4 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace('AAabcbaAA', val1, NULL) IS NULL ORDER BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
(4 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b" WHERE (REPLACE('XYZ','X',RTRIM("val1")) = 'abcbaYZ')
(4 rows)

SELECT id, val1 FROM ft_char_b WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Sort
   Sort Key: ft_char_b.id
   CTE ft_char_b
     ->  Foreign Scan on ft_char_b
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
   ->  CTE Scan on ft_char_b
         Filter: (replace('XYZ'::text, 'X'::text, (val1)::text) = 'abcbaYZ'::text)
(7 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
(1 row)

SELECT id, val1 FROM ft_char_b WHERE replace('', 'X', val1) IS NULL ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          val1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 | 
  2 | 
  3 | abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  4 | あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  5 |  abcba                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  6 |  あいういあ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  7 |  ＡａＢｂＣｃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
(7 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace('', 'X', val1) IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

SELECT id, val1 FROM ft_char_b WHERE replace('XYZ', '', val1) IS NULL ORDER BY id;
 id | val1 
----+------
(0 rows)

WITH ft_char_b AS (SELECT id, val1 FROM ft_char_b)
SELECT id, val1 FROM ft_char_b WHERE replace('XYZ', '', val1) IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace(NULL, 'X', val1) IS NULL ORDER BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
(4 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_char_b WHERE replace('XYZ', NULL, val1) IS NULL ORDER BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_char_b
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_char_b"
(4 rows)

-- varchar2
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b" WHERE (REPLACE("val1",'a','A') = 'AbcbA')
(4 rows)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: ft_varchar2_b_varchar.id
   CTE ft_varchar2_b_varchar
     ->  Foreign Scan on ft_varchar2_b_varchar
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
   ->  CTE Scan on ft_varchar2_b_varchar
         Filter: (replace((val1)::text, 'a'::text, 'A'::text) = 'AbcbA'::text)
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, '', 'ABC') = 'abcba' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, '', 'ABC') = 'abcba' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
(4 rows)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'abc', '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'abc', '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
(4 rows)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b" WHERE (REPLACE('AAabcbaAA',"val1",'X') = 'AAXAA')
(4 rows)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Sort
   Sort Key: ft_varchar2_b_varchar.id
   CTE ft_varchar2_b_varchar
     ->  Foreign Scan on ft_varchar2_b_varchar
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
   ->  CTE Scan on ft_varchar2_b_varchar
         Filter: (replace('AAabcbaAA'::text, (val1)::text, 'X'::text) = 'AAXAA'::text)
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('', val1, 'X') IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('', val1, 'X') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('', val1, '') IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('', val1, '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(NULL, val1, 'X') IS NULL ORDER BY id;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
(4 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('AAabcbaAA', val1, NULL) IS NULL ORDER BY id;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
(4 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b" WHERE (REPLACE('XYZ','X',"val1") = 'abcbaYZ')
(4 rows)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Sort
   Sort Key: ft_varchar2_b_varchar.id
   CTE ft_varchar2_b_varchar
     ->  Foreign Scan on ft_varchar2_b_varchar
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
   ->  CTE Scan on ft_varchar2_b_varchar
         Filter: (replace('XYZ'::text, 'X'::text, (val1)::text) = 'abcbaYZ'::text)
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('', 'X', val1) IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('', 'X', val1) IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('XYZ', '', val1) IS NULL ORDER BY id;
 id | val1 
----+------
(0 rows)

WITH ft_varchar2_b_varchar AS (SELECT id, val1 FROM ft_varchar2_b_varchar)
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('XYZ', '', val1) IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace(NULL, 'X', val1) IS NULL ORDER BY id;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
(4 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_varchar2_b_varchar WHERE replace('XYZ', NULL, val1) IS NULL ORDER BY id;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_varchar2_b_varchar
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_varchar2_b"
(4 rows)

-- nclob
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob" WHERE (REPLACE("val1",'a','A') = 'AbcbA')
(4 rows)

SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
ERROR:  OCI_ERROR - ORA-00932: データ型が一致しません: -が予想されましたがNCLOBです。

EXPLAIN (COSTS FALSE) 
WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort
   Sort Key: ft_nclob_text.id
   CTE ft_nclob_text
     ->  Foreign Scan on ft_nclob_text
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
   ->  CTE Scan on ft_nclob_text
         Filter: (replace(val1, 'a'::text, 'A'::text) = 'AbcbA'::text)
(7 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'a', 'A') = 'AbcbA' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, '', 'ABC') = 'abcba' ORDER BY id;
ERROR:  OCI_ERROR - ORA-00932: データ型が一致しません: -が予想されましたがNCLOBです。

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, '', 'ABC') = 'abcba' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
(4 rows)

SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, NULL, 'ABC') IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'abc', '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'abc', '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
(4 rows)

SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace(val1, 'abc', NULL) IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob" WHERE (REPLACE('AAabcbaAA',"val1",'X') = 'AAXAA')
(4 rows)

SELECT id, val1 FROM ft_nclob_text WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Sort
   Sort Key: ft_nclob_text.id
   CTE ft_nclob_text
     ->  Foreign Scan on ft_nclob_text
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
   ->  CTE Scan on ft_nclob_text
         Filter: (replace('AAabcbaAA'::text, val1, 'X'::text) = 'AAXAA'::text)
(7 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace('AAabcbaAA', val1, 'X') = 'AAXAA' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

SELECT id, val1 FROM ft_nclob_text WHERE replace('', val1, 'X') IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace('', val1, 'X') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

SELECT id, val1 FROM ft_nclob_text WHERE replace('', val1, '') IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace('', val1, '') IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace(NULL, val1, 'X') IS NULL ORDER BY id;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
(4 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace('AAabcbaAA', val1, NULL) IS NULL ORDER BY id;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
(4 rows)

--
EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob" WHERE (REPLACE('XYZ','X',"val1") = 'abcbaYZ')
(4 rows)

SELECT id, val1 FROM ft_nclob_text WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

EXPLAIN (COSTS FALSE) 
WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort
   Sort Key: ft_nclob_text.id
   CTE ft_nclob_text
     ->  Foreign Scan on ft_nclob_text
           Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
   ->  CTE Scan on ft_nclob_text
         Filter: (replace('XYZ'::text, 'X'::text, val1) = 'abcbaYZ'::text)
(7 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace('XYZ', 'X', val1) = 'abcbaYZ' ORDER BY id;
 id | val1  
----+-------
  3 | abcba
(1 row)

SELECT id, val1 FROM ft_nclob_text WHERE replace('', 'X', val1) IS NULL ORDER BY id;
 id |     val1      
----+---------------
  1 | 
  2 | 
  3 | abcba
  4 | あいういあ
  5 |  abcba
  6 |  あいういあ
  7 |  ＡａＢｂＣｃ
(7 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace('', 'X', val1) IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

SELECT id, val1 FROM ft_nclob_text WHERE replace('XYZ', '', val1) IS NULL ORDER BY id;
 id | val1 
----+------
(0 rows)

WITH ft_nclob_text AS (SELECT id, val1 FROM ft_nclob_text)
SELECT id, val1 FROM ft_nclob_text WHERE replace('XYZ', '', val1) IS NULL ORDER BY id;
 id | val1 
----+------
  1 | 
  2 | 
(2 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace(NULL, 'X', val1) IS NULL ORDER BY id;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
(4 rows)

EXPLAIN (COSTS FALSE) 
SELECT id, val1 FROM ft_nclob_text WHERE replace('XYZ', NULL, val1) IS NULL ORDER BY id;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort
   Sort Key: id
   ->  Foreign Scan on ft_nclob_text
         Remote SQL: SELECT "id", "val1", NULL FROM "oracle_fdw"."t_nclob"
(4 rows)

